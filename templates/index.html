<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Love</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body {
    margin: 0;
    background: linear-gradient(135deg, #ff4e6a, #ff8fa3);
    font-family: Arial, sans-serif;
    color: white;
    text-align: center;
}

.screen {
    display: none;
    padding: 25px;
    min-height: 100vh;
    box-sizing: border-box;
    opacity: 0;
    transform: translateY(20px);
    transition: opacity .4s ease, transform .4s ease;
}

.screen.active {
    display: block;
    opacity: 1;
    transform: translateY(0);
}

.active {
    display: block;
}

h1 {
    font-size: 28px;
}

button {
    width: 80%;
    padding: 18px;
    font-size: 20px;
    margin-top: 20px;
    border: none;
    border-radius: 25px;
    background: white;
    color: #ff4e6a;
    font-weight: bold;
    box-shadow: 0 8px 18px rgba(0,0,0,.15);
    transition: transform .12s ease, box-shadow .12s ease;
}
button:active {
    transform: scale(.96);
    box-shadow: 0 4px 10px rgba(0,0,0,.2);
}
#game {
    position: relative;
    height: 60vh;
}

.heart {
    position: absolute;
    font-size: 38px;
    cursor: pointer;
}

.answer {
    background: white;
    color: #ff4e6a;
    margin: 12px auto;
    padding: 14px;
    width: 80%;
    border-radius: 20px;
    font-size: 18px;
}

#time {
    font-size: 24px;
    margin-top: 20px;
}


@keyframes fall {
    from { transform: translateY(0); }
    to { transform: translateY(100vh); }
}

#photo {
    width: 92%;
    height: 65vh;
    object-fit: cover;
    object-position: center;
    border-radius: 20px;
    box-shadow: 0 12px 30px rgba(0,0,0,.25);
    transition: transform .35s ease, opacity .35s ease;
}
#photo.zoom {
    transform: scale(1.03);
}
#hearts-bg {
    position: fixed;
    width: 100%;
    height: 100%;
    overflow: hidden;
    top: 0;
    left: 0;
    pointer-events: none;
    z-index: 0;
}

.fall-heart {
    position: absolute;
    top: -20px;
    font-size: 18px;
    animation: fall 6s linear forwards;
}

@keyframes fall {
    to {
        transform: translateY(110vh);
        opacity: 0;
    }
}
#poop-bg {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    z-index: 0;
}

.poop {
    position: absolute;
    font-size: 24px;
    animation: float 6s linear infinite;
}

@keyframes float {
    0% { transform: translateY(-10vh); }
    100% { transform: translateY(110vh); }
}


</style>
</head>

<body>
<div id="hearts-bg"></div>

<!-- –°–¢–ê–†–¢ -->
<div id="start" class="screen active">
    <h1>‚ù§Ô∏è –ê–Ω—É —Ä–∞—Å—á–µ—Ö–ª—è–π –±—É—Å–∏–Ω–∫–∞</h1>
    <button onclick="startGame()">–†–∞—Å—á–µ—Ö–ª–∏—Ç—å</button>
</div>



<!-- –ò–ì–†–ê -->
<div id="gameScreen" class="screen">
    <h1>–ù–∞–π–¥–∏ 5 —Å–µ—Ä–¥–µ—Ü ‚ù§Ô∏è</h1>
    <div id="game"></div>
    <div id="gameText"></div>
</div>

<!-- –¢–ï–°–¢ -->
<div id="testScreen" class="screen">
    <h1>–û—Ç–≤–µ—Ç—å —á–µ—Å—Ç–Ω–æ üòè</h1>
    <div id="question"></div>
</div>

<!-- –í–†–ï–ú–Ø -->
<div id="timeScreen" class="screen">
    <h1>–¢—ã –≤ –º–æ–µ–º —Å–µ—Ä–¥—Ü–µ —É–∂–µ:</h1>
    <div id="time"></div>

    <div id="finalText" style="margin-top:25px;font-size:26px;opacity:0;transition:1s;">
        –Ø —Ç–µ–±—è –ª—é–±–ª—é ‚ù§Ô∏è
    </div>

    <button id="secretBtn" style="opacity:0;" onclick="showSecret()">
        –û—Ç–∫—Ä—ã—Ç—å —Å–µ–∫—Ä–µ—Ç
    </button>

    <div id="secret" style="margin-top:20px;font-size:22px;display:none;">
        –¢—ã —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π —á–µ–ª–æ–≤–µ–∫ –≤ –º–æ–µ–π –∂–∏–∑–Ω–∏ üíñ
    </div>
    <button onclick="goMusic()">–î–∞–ª—å—à–µ ‚Üí</button>

    <div id="confetti"></div>
</div>

<div id="musicScreen" class="screen">
    <h1>–ú—É–∑—ã–∫–∞ –∫–æ—Ç–æ—Ä–∞—è —Å —Ç–æ–±–æ–π —Å–≤—è–∑–∞–Ω–∞ üéµ</h1>

    <audio id="music" controls>
        <source src="https://valentine-rthw.onrender.com/music/obrat.mp3" type="audio/mpeg">

    </audio>

    <br><br>
    <button onclick="goPhotos()">–î–∞–ª—å—à–µ ‚Üí</button>
</div>

<div id="photoScreen" class="screen">
    <h1>–ù–∞—à–∏ –º–æ–º–µ–Ω—Ç—ã üì∏</h1>

        <img id="photo" src="/photos/1.jpg"
         style="
            width:92%;
            height:65vh;
            object-fit:cover;
            object-position:center;
            border-radius:20px;
         ">
    <br><br>
    <button onclick="nextPhoto()">–°–ª–µ–¥—É—é—â–µ–µ —Ñ–æ—Ç–æ</button>
    <br><br>
    <button onclick="goFinal()">–î–∞–ª—å—à–µ ‚Üí</button>
</div>
<div id="loveScreen" class="screen">
    <h1>–ü–æ—á–µ–º—É —è —Ç–µ–±—è –ª—é–±–ª—é‚Ä¶</h1>
    <div id="loveText" style="font-size:22px;margin-top:30px;"></div>
</div>


<div id="poopScreen" class="screen">
    <div id="poop-bg"></div>

    <div style="position:relative; z-index:2;">
        <div style="font-size:80px;">üåπ</div>

        <h2 style="margin-top:20px;">
            –¢—ã –∫–∞–∫ —Ä–æ–∑–∞ —Å—Ä–µ–¥–∏ –∫–∞–∫–∞—à–µ–∫
        </h2>

        <button onclick="goLove()">–î–∞–ª—å—à–µ ‚Üí</button>
    </div>
</div>


<div id="finalScreen" class="screen">
    <h1>–Ø —Ç–µ–±—è –ª—é–±–ª—é ‚ù§Ô∏è</h1>
    <h2>–°–ø–∞—Å–∏–±–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å</h2>
</div>



<script>
const tg = window.Telegram.WebApp;
tg.expand();

function show(id){
    document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
    document.getElementById(id).classList.add("active");
}

//
// 1Ô∏è‚É£ –ò–ì–†–ê
//
let found = 0;

function startGame(){
    show("gameScreen");
    spawnHeart();
}

function spawnHeart(){
    const heart = document.createElement("div");
    heart.className = "heart";
    heart.innerHTML = "‚ù§Ô∏è";

    heart.style.left = Math.random()*80 + "%";
    heart.style.top = Math.random()*60 + "%";

    heart.onclick = () => {
        heart.remove();
        found++;

        if(found >= 5){
            document.getElementById("gameText").innerHTML =
            "<h2>–£–∫—Ä–∞–ª–∞ –º–æ–µ —Å–µ—Ä–¥—Ü–µ........</h2>";

            setTimeout(startTest, 1500);
        } else {
            spawnHeart();
        }
    };

    document.getElementById("game").appendChild(heart);
}

//
// 2Ô∏è‚É£ –¢–ï–°–¢
//
const questions = [
{
    q: "–¢—ã –∫–∞–∫ –≤–∞—â–µ –ª—é–±–∏—à—å –î–∞–Ω—å–∫–∞?",
    a: ["–î–∞", "–û—á–µ–Ω—å", "–ë–µ–∑—É–º–Ω–æ"]
},
{
    q: "–ö—Ç–æ —Å–∞–º—ã–π –ª—É—á—à–∏–π —á–µ–ª–æ–≤–µ–∫?",
    a: ["–î–∞–Ω–∏–∏–ª –ß—É–º–∞–∫–æ–≤", "–ó–∞–∫–∏–∫—é", "–î–∞–Ω—è"]
},
{
    q: "–ö–∞–∫—É—é —Ñ–æ—Ä–º—É –ø—Ä–∏–Ω–∏–º–∞—é—Ç –º–æ–∏ –∫–∏—à–µ—á–Ω—ã–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è",
    a: ["–£–∑–µ–ª–æ–∫", "—Å—Ç–æ–ª–±–∏–∫", "—Ä–∏–µ–ª—Ç–æ—Ä", "–≥–∏–¥—Ä–æ—ç–ª–µ–∫—Ç—Ä–æ—Å—Ç–∞–Ω—Ü–∏–∏", "–º–∞—Å–ª–µ–Ω–Ω–æ–≥–æ –æ—Ç–¥–µ–ª–æ—á–Ω–æ–≥–æ —Å–≤—è–∑—É—é—â–µ–≥–æ –∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä–∞"]
}
];

let qIndex = 0;

function startTest(){
    show("testScreen");
    renderQuestion();
}

function renderQuestion(){
    const q = questions[qIndex];
    let html = "<h2>"+q.q+"</h2>";

    q.a.forEach(ans => {
        html += `<div class="answer" onclick="nextQ()">${ans}</div>`;
    });

    document.getElementById("question").innerHTML = html;
}

function nextQ(){
    qIndex++;

    if(qIndex >= questions.length){
        startTimeScreen();
    } else {
        renderQuestion();
    }
}

//
// 3Ô∏è‚É£ –í–†–ï–ú–Ø –í–ú–ï–°–¢–ï
//
function startTimeScreen(){
    show("timeScreen");

    const startDate = new Date("2024-09-01"); // ‚Üê –ø–æ—Å—Ç–∞–≤—å —Å–≤–æ—é –¥–∞—Ç—É

    function update(){
        const now = new Date();
        const diff = now - startDate;

        const days = Math.floor(diff / (1000*60*60*24));
        const hours = Math.floor(diff / (1000*60*60));
        const minutes = Math.floor(diff / (1000*60));
        const seconds = Math.floor(diff / 1000);

        document.getElementById("time").innerHTML =
            days + " –¥–Ω–µ–π<br>" +
            hours + " —á–∞—Å–æ–≤<br>" +
            minutes + " –º–∏–Ω—É—Ç<br>" +
            seconds + " —Å–µ–∫—É–Ω–¥ ‚ù§Ô∏è";
    }

    update();
    setInterval(update, 1000);

    // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–Ω–∏–µ
    setTimeout(() => {
        document.getElementById("finalText").style.opacity = 1;
        document.getElementById("secretBtn").style.opacity = 1;
        startConfetti();
    }, 3000);
}
function showSecret(){
    document.getElementById("secret").style.display = "block";
}

function startConfetti(){
    const container = document.getElementById("confetti");

    setInterval(() => {
        const heart = document.createElement("div");
        heart.innerHTML = "‚ù§Ô∏è";
        heart.style.position = "absolute";
        heart.style.left = Math.random()*100 + "%";
        heart.style.top = "-20px";
        heart.style.fontSize = "24px";
        heart.style.animation = "fall 4s linear";
        container.appendChild(heart);

        setTimeout(()=>heart.remove(),4000);
    }, 300);
}

//
// –ü–ï–†–ï–•–û–î–´
//
function goMusic(){
    show("musicScreen");

    const music = document.getElementById("music");
    music.currentTime = 0;
    music.volume = 0.6;
    music.play().catch(()=>{});
}

function goPhotos(){
    show("photoScreen");
    setTimeout(()=>{
        document.getElementById("photo").classList.add("zoom");
    }, 300);
}

function goFinal(){
    goPoop();
}

function goLove(){
    startLoveScreen();
}

//
// –§–û–¢–û
//
const photos = [
    "https://valentine-rthw.onrender.com/photos/1.jpg",
    "https://valentine-rthw.onrender.com/photos/2.jpg",
    "https://valentine-rthw.onrender.com/photos/3.jpg"
];
let photoIndex = 0;

function nextPhoto(){
    const img = document.getElementById("photo");

    img.style.opacity = 0;
    img.classList.remove("zoom");

    setTimeout(() => {
        photoIndex++;
        if(photoIndex >= photos.length){
            photoIndex = 0;
        }
        img.src = photos[photoIndex];
        img.style.opacity = 1;
        img.classList.add("zoom");
    }, 200);
}

function startHeartsRain(){
    const container = document.getElementById("hearts-bg");

    setInterval(() => {
        const heart = document.createElement("div");
        heart.className = "fall-heart";
        heart.innerHTML = "‚ù§Ô∏è";

        heart.style.left = Math.random()*100 + "%";
        heart.style.fontSize = (14 + Math.random()*16) + "px";

        container.appendChild(heart);

        setTimeout(()=>heart.remove(),6000);
    }, 300);
}

startHeartsRain();

const loveLines = [
    "–Ø –ª—é–±–ª—é —Ç–µ–±—è –∑–∞ —Ç–≤–æ–∏ –≥–ª–∞–∑–∞ –±–µ–∑—É–º–Ω–æ –∫—Ä–∞—Å–∏–≤—ã–µ ‚ù§Ô∏è",
    "–ó–∞ —Ç–≤–æ—é –¥–æ–±—Ä–æ—Ç—É –∫ –∫–æ—Ç–µ–∫–∞–º –∏ —Å–æ–±–∞—á–∫–∞–º",
    "–ó–∞ —Ç–≤–æ—é –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ –≥—Ä—É—Å—Ç–Ω—ã–µ –≤—Ä–µ–º–µ–Ω–∞",
    "–ó–∞ —Ç–≤–æ–π —Å–º–µ—Ö —Å–º–µ—à–Ω–æ–π",
    "–ó–∞ —Ç–æ —á—Ç–æ —Ç—ã –æ—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–∞",
    "–ó–∞ —Å–∞–º—É—é –∫–ª–∞—Å—Å–Ω—É—é –ø–æ–ø—É –Ω–∞ —Å–≤–µ—Ç–µ...",
    "–ó–∞ —Ç–æ, —á—Ç–æ —Ç—ã –µ—Å—Ç—å —É –º–µ–Ω—è"
];
function startLoveScreen(){
    show("loveScreen");

    const el = document.getElementById("loveText");
    let lineIndex = 0;
    let charIndex = 0;

    function type(){
        if(lineIndex >= loveLines.length){
            setTimeout(showRealFinal, 1500);
            return;
        }

        const line = loveLines[lineIndex];

        if(charIndex < line.length){
            el.innerHTML += line.charAt(charIndex);
            charIndex++;
            setTimeout(type, 40);
        } else {
            el.innerHTML += "<br><br>";
            lineIndex++;
            charIndex = 0;
            setTimeout(type, 600);
        }
    }

    type();
}

function showRealFinal(){
    show("finalScreen");

    if(navigator.vibrate){
        navigator.vibrate([300, 150, 300, 150, 600]);
    }
}

function goPoop(){
    show("poopScreen");
    startPoops();
}

function startPoops(){
    const bg = document.getElementById("poop-bg");

    for(let i = 0; i < 40; i++){
        const p = document.createElement("div");
        p.className = "poop";
        p.innerHTML = "üí©";

        p.style.left = Math.random()*100 + "%";
        p.style.top = Math.random()*100 + "%";
        p.style.fontSize = (18 + Math.random()*25) + "px";

        bg.appendChild(p);
    }
}

</script>

</body>
</html>
